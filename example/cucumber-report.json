[{"line":1,"elements":[{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":245626058,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":886162,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-20T00:17:11.871Z","line":7,"name":"Verify on startup the Minion has no tasks deployed","description":"","id":"minion-basic-functionality;verify-on-startup-the-minion-has-no-tasks-deployed","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":769986659,"status":"passed"},"line":8,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until success with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":124}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilSuccessWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":6512512,"status":"passed"},"line":9,"name":"DEBUG dump the response body","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.debugDumpTheResponseBody()"},"keyword":"Then "},{"result":{"duration":735601,"status":"passed"},"line":10,"name":"parse the JSON response","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.parseTheJsonResponse()"},"keyword":"Then "},{"result":{"error_message":"org.junit.ComparisonFailure: matching to JSON path total expected:<[999]> but was:<[0]>\n\tat org.junit.Assert.assertEquals(Assert.java:117)\n\tat docker.it@0.1.0-SNAPSHOT/org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionMatch(MinionTestSteps.java:186)\n\tat docker.it@0.1.0-SNAPSHOT/org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionsMatch(MinionTestSteps.java:136)\n\tat âœ½.verify JSON path expressions match(classpath:org/opennms/horizon/dockerit/minion.feature:11)\n","duration":249400195,"status":"failed"},"line":11,"name":"verify JSON path expressions match","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionsMatch(java.util.List<java.lang.String>)"},"rows":[{"cells":["total == 999"]},{"cells":["serviceCount == 0"]}],"keyword":"Then "}]},{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":573221,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":280681,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-20T00:17:13.197Z","line":15,"name":"Wait for Minion to register with the Mock Gateway","description":"","id":"minion-basic-functionality;wait-for-minion-to-register-with-the-mock-gateway","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":106294971,"status":"passed"},"line":16,"name":"MOCK wait for minion connection with id \"test-minion-001\" and location \"Default\" timeout 30000ms","match":{"arguments":[{"val":"\"test-minion-001\"","offset":40},{"val":"\"Default\"","offset":71},{"val":"30000","offset":89}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.waitForMinionConnection(java.lang.String,java.lang.String,int)"},"keyword":"Then "}]},{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":407011,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":228291,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-20T00:17:13.312Z","line":18,"name":"Add a task to the Minion (via the Minion Gateway) and verify the task is deployed","description":"","id":"minion-basic-functionality;add-a-task-to-the-minion-(via-the-minion-gateway)-and-verify-the-task-is-deployed","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":12232573,"status":"passed"},"line":19,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until success with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":124}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilSuccessWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":106710,"status":"passed"},"line":20,"name":"Remember response body for later comparison","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.rememberResponseBodyForLaterComparison()"},"keyword":"Then "},{"result":{"duration":4518170,"status":"passed"},"line":22,"name":"MOCK twin update in resource file \"/testdata/task-set.twin.001.json\"","match":{"arguments":[{"val":"\"/testdata/task-set.twin.001.json\"","offset":34}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.mockTwinUpdateInResourceFile(java.lang.String)"},"keyword":"Given "},{"result":{"duration":41836313,"status":"passed"},"line":23,"name":"MOCK send twin update for topic \"task-set\" at location \"Default\"","match":{"arguments":[{"val":"\"task-set\"","offset":32},{"val":"\"Default\"","offset":55}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.sendTwinUpdateForTopic(java.lang.String,java.lang.String)"},"keyword":"Then "},{"result":{"duration":78777346,"status":"passed"},"line":25,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until response changes with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":133}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilResponseChangesWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":266000,"status":"passed"},"line":27,"name":"DEBUG dump the response body","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.debugDumpTheResponseBody()"},"keyword":"Then "},{"result":{"duration":106251,"status":"passed"},"line":28,"name":"parse the JSON response","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.parseTheJsonResponse()"},"keyword":"Then "},{"result":{"duration":9016177,"status":"passed"},"line":29,"name":"verify JSON path expressions match","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionsMatch(java.util.List<java.lang.String>)"},"rows":[{"cells":["serviceCount == 1"]}],"keyword":"Then "}]},{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":555331,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":280570,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-20T00:17:13.468Z","line":32,"name":"Add another task to the Minion (via the Minion Gateway) and verify the task is deployed","description":"","id":"minion-basic-functionality;add-another-task-to-the-minion-(via-the-minion-gateway)-and-verify-the-task-is-deployed","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":8127986,"status":"passed"},"line":33,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\"","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPath(java.lang.String)"},"keyword":"Then "},{"result":{"duration":115280,"status":"passed"},"line":34,"name":"Remember response body for later comparison","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.rememberResponseBodyForLaterComparison()"},"keyword":"Then "},{"result":{"duration":524670,"status":"passed"},"line":36,"name":"MOCK twin update in resource file \"/testdata/task-set.twin.002.json\"","match":{"arguments":[{"val":"\"/testdata/task-set.twin.002.json\"","offset":34}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.mockTwinUpdateInResourceFile(java.lang.String)"},"keyword":"Given "},{"result":{"duration":12265474,"status":"passed"},"line":37,"name":"MOCK send twin update for topic \"task-set\" at location \"Default\"","match":{"arguments":[{"val":"\"task-set\"","offset":32},{"val":"\"Default\"","offset":55}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.sendTwinUpdateForTopic(java.lang.String,java.lang.String)"},"keyword":"Then "},{"result":{"duration":15904882,"status":"passed"},"line":39,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until response changes with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":133}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilResponseChangesWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":312541,"status":"passed"},"line":40,"name":"DEBUG dump the response body","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.debugDumpTheResponseBody()"},"keyword":"Then "},{"result":{"duration":99601,"status":"passed"},"line":41,"name":"parse the JSON response","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.parseTheJsonResponse()"},"keyword":"Then "},{"result":{"duration":9916040,"status":"passed"},"line":42,"name":"verify JSON path expressions match","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionsMatch(java.util.List<java.lang.String>)"},"rows":[{"cells":["serviceCount == 2"]}],"keyword":"Then "}]}],"name":"Minion Basic Functionality","description":"","id":"minion-basic-functionality","keyword":"Feature","uri":"classpath:org/opennms/horizon/dockerit/minion.feature","tags":[]}]