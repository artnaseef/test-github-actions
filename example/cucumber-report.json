[{"line":1,"elements":[{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":227655699,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":934532,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-18T22:23:45.884Z","line":7,"name":"Verify on startup the Minion has no tasks deployed","description":"","id":"minion-basic-functionality;verify-on-startup-the-minion-has-no-tasks-deployed","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":832032906,"status":"passed"},"line":8,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until success with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":124}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilSuccessWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":7239979,"status":"passed"},"line":9,"name":"DEBUG dump the response body","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.debugDumpTheResponseBody()"},"keyword":"Then "},{"result":{"duration":720531,"status":"passed"},"line":10,"name":"parse the JSON response","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.parseTheJsonResponse()"},"keyword":"Then "},{"result":{"duration":231404623,"status":"passed"},"line":11,"name":"verify JSON path expressions match","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionsMatch(java.util.List<java.lang.String>)"},"rows":[{"cells":["total == 0"]},{"cells":["serviceCount == 0"]}],"keyword":"Then "}]},{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":427001,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":232210,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-18T22:23:47.228Z","line":15,"name":"Wait for Minion to register with the Mock Gateway","description":"","id":"minion-basic-functionality;wait-for-minion-to-register-with-the-mock-gateway","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":90046865,"status":"passed"},"line":16,"name":"MOCK wait for minion connection with id \"test-minion-001\" and location \"Default\" timeout 30000ms","match":{"arguments":[{"val":"\"test-minion-001\"","offset":40},{"val":"\"Default\"","offset":71},{"val":"30000","offset":89}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.waitForMinionConnection(java.lang.String,java.lang.String,int)"},"keyword":"Then "}]},{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":382071,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":232050,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-18T22:23:47.326Z","line":18,"name":"Add a task to the Minion (via the Minion Gateway) and verify the task is deployed","description":"","id":"minion-basic-functionality;add-a-task-to-the-minion-(via-the-minion-gateway)-and-verify-the-task-is-deployed","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":14172575,"status":"passed"},"line":19,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until success with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":124}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilSuccessWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":86360,"status":"passed"},"line":20,"name":"Remember response body for later comparison","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.rememberResponseBodyForLaterComparison()"},"keyword":"Then "},{"result":{"duration":4019483,"status":"passed"},"line":22,"name":"MOCK twin update in resource file \"/testdata/task-set.twin.001.json\"","match":{"arguments":[{"val":"\"/testdata/task-set.twin.001.json\"","offset":34}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.mockTwinUpdateInResourceFile(java.lang.String)"},"keyword":"Given "},{"result":{"duration":38971652,"status":"passed"},"line":23,"name":"MOCK send twin update for topic \"task-set\" at location \"Default\"","match":{"arguments":[{"val":"\"task-set\"","offset":32},{"val":"\"Default\"","offset":55}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.sendTwinUpdateForTopic(java.lang.String,java.lang.String)"},"keyword":"Then "},{"result":{"duration":81437106,"status":"passed"},"line":25,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until response changes with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":133}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilResponseChangesWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":243440,"status":"passed"},"line":27,"name":"DEBUG dump the response body","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.debugDumpTheResponseBody()"},"keyword":"Then "},{"result":{"duration":75980,"status":"passed"},"line":28,"name":"parse the JSON response","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.parseTheJsonResponse()"},"keyword":"Then "},{"result":{"duration":7774338,"status":"passed"},"line":29,"name":"verify JSON path expressions match","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionsMatch(java.util.List<java.lang.String>)"},"rows":[{"cells":["serviceCount == 1"]}],"keyword":"Then "}]},{"line":3,"name":"Configure base URLs","description":"","type":"background","keyword":"Background","steps":[{"result":{"duration":466001,"status":"passed"},"line":4,"name":"MOCK Minion Gateway Base URL in system property \"mock-miniongateway.base-url\"","match":{"arguments":[{"val":"\"mock-miniongateway.base-url\"","offset":48}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.minionGatewayBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "},{"result":{"duration":312260,"status":"passed"},"line":5,"name":"Application Base URL in system property \"application.base-url\"","match":{"arguments":[{"val":"\"application.base-url\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.applicationBaseURLInSystemProperty(java.lang.String)"},"keyword":"Given "}]},{"start_timestamp":"2023-01-18T22:23:47.482Z","line":32,"name":"Add another task to the Minion (via the Minion Gateway) and verify the task is deployed","description":"","id":"minion-basic-functionality;add-another-task-to-the-minion-(via-the-minion-gateway)-and-verify-the-task-is-deployed","type":"scenario","keyword":"Scenario","steps":[{"result":{"duration":8846648,"status":"passed"},"line":33,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\"","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPath(java.lang.String)"},"keyword":"Then "},{"result":{"duration":119861,"status":"passed"},"line":34,"name":"Remember response body for later comparison","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.rememberResponseBodyForLaterComparison()"},"keyword":"Then "},{"result":{"duration":433940,"status":"passed"},"line":36,"name":"MOCK twin update in resource file \"/testdata/task-set.twin.002.json\"","match":{"arguments":[{"val":"\"/testdata/task-set.twin.002.json\"","offset":34}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.mockTwinUpdateInResourceFile(java.lang.String)"},"keyword":"Given "},{"result":{"duration":12909194,"status":"passed"},"line":37,"name":"MOCK send twin update for topic \"task-set\" at location \"Default\"","match":{"arguments":[{"val":"\"task-set\"","offset":32},{"val":"\"Default\"","offset":55}],"location":"org.opennms.horizon.testtool.miniongateway.wiremock.client.MinionGatewayWiremockTestSteps.sendTwinUpdateForTopic(java.lang.String,java.lang.String)"},"keyword":"Then "},{"result":{"duration":9351501,"status":"passed"},"line":39,"name":"Send GET request to application at path \"/ignite-worker/service-deployment/metrics?verbose=true\" until response changes with timeout 60000ms","match":{"arguments":[{"val":"\"/ignite-worker/service-deployment/metrics?verbose=true\"","offset":40},{"val":"60000","offset":133}],"location":"org.opennms.horizon.dockerit.MinionTestSteps.sendGETRequestToApplicationAtPathUntilResponseChangesWithTimeoutMs(java.lang.String,int)"},"keyword":"Then "},{"result":{"duration":270951,"status":"passed"},"line":40,"name":"DEBUG dump the response body","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.debugDumpTheResponseBody()"},"keyword":"Then "},{"result":{"duration":87700,"status":"passed"},"line":41,"name":"parse the JSON response","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.parseTheJsonResponse()"},"keyword":"Then "},{"result":{"duration":8508488,"status":"passed"},"line":42,"name":"verify JSON path expressions match","match":{"location":"org.opennms.horizon.dockerit.MinionTestSteps.verifyJsonPathExpressionsMatch(java.util.List<java.lang.String>)"},"rows":[{"cells":["serviceCount == 2"]}],"keyword":"Then "}]}],"name":"Minion Basic Functionality","description":"","id":"minion-basic-functionality","keyword":"Feature","uri":"classpath:org/opennms/horizon/dockerit/minion.feature","tags":[]}]